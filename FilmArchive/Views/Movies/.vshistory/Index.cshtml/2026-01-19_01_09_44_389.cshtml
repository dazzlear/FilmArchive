@model IEnumerable<FilmArchive.Models.Movie>

@{
    ViewData["Title"] = "Archive";
}

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@400;700;900&display=swap" rel="stylesheet">

<style>
    body {
        background-color: #000000;
        font-family: 'Urbanist', sans-serif;
        color: #fff;
    }

    .glass {
        background: rgba(255, 255, 255, 0.09);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.05);
    }

        .glass:hover, .glass:focus-within {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(109, 40, 217, 0.5);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        }

    .btn-violet {
        background-color: #6d28d9;
        transition: all 0.3s ease;
    }
    
        .btn-violet:hover {
            background-color: #7c3aed;
            box-shadow: 0 0 20px rgba(124, 58, 237, 0.4);
        }

    dialog::backdrop {
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(10px);
    }

    .toast-in {
        animation: slideIn 0.5s ease-out forwards;
    }

    .bg-violet{
        background-color: #6d28d9;
    }

    @@keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }

        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
</style>

<div class="max-w-7xl mx-auto px-6 py-8">
    <div id="toastContainer" class="fixed bottom-10 right-10 z-[100] flex flex-col gap-3">
        @if (TempData["Success"] != null)
        {
            <div class="toast-in bg-violet-600 text-white px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 border border-violet-500/30">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                <span class="font-bold text-xs uppercase tracking-widest">@TempData["Success"]</span>
            </div>
        }
    </div>

    <header class="flex justify-between items-center mb-10">
        <div class="flex items-center gap-4">
            <div class="w-10 h-10 bg-gradient-to-tr from-indigo-600 to-violet-500 rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-500/20 rotate-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z" />
                    <path d="m6.2 5.3 3.1 3.9" />
                    <path d="m12.4 3.4 3.1 4" />
                    <path d="M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z" />
                </svg>
            </div>

            <div>
                <h1 class="text-2xl font-black tracking-tight text-white uppercase">
                    Film<span class="text-indigo-500 italic">Archive</span>
                </h1>
            </div>
        </div>

        <button onclick="document.getElementById('createModal').showModal()"
                class="bg-white text-black px-6 py-2.5 rounded-lg font-black text-[10px] uppercase tracking-widest hover:bg-violet-500 hover:text-white transition-all">
            + New Archive
        </button>
    </header>

    <section class="mb-12">
        <form method="get" class="glass rounded-full p-2 flex items-center gap-3 max-w-4xl mx-auto shadow-2xl border border-white/10">

            @* Search Input Area *@
            <div class="flex-1 flex items-center px-6">
                <svg class="w-5 h-5 text-zinc-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <input name="searchTerm"
                       placeholder="Search movie or series..."
                       class="bg-transparent border-none outline-none text-white w-full focus:ring-0 px-4 py-3 font-semibold text-sm placeholder:text-zinc-500" />
            </div>

            <div class="relative flex items-center">
                <select name="genre" onchange="this.form.submit()" class="bg-violet-600 text-white border-none rounded-full pl-6 pr-10 py-3 text-[10px] font-black uppercase tracking-widest outline-none cursor-pointer appearance-none w-auto min-w-[110px] transition-all hover:bg-violet-500">

                    @* Fixed: Reset Genre option with correct Razor 'selected' logic *@
                    <option value="All" selected="@(Context.Request.Query["genre"] == "All" ? "selected" : null)">
                        Genres
                    </option>

                    @if (ViewBag.Genres != null)
                    {
                        foreach (var genre in ViewBag.Genres)
                        {
                            <option value="@genre" selected="@(Context.Request.Query["genre"] == genre.ToString() ? "selected" : null)">
                                @genre.ToUpper()
                            </option>
                        }
                    }
                </select>

                @* Custom Arrow *@
                <div class="absolute inset-y-0 right-4 flex items-center pointer-events-none">
                    <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
            </div>

            @* Search Icon Button *@
            <button type="submit" class="btn-violet text-white h-[46px] w-[46px] flex items-center justify-center rounded-full hover:scale-105 active:scale-95 transition-all shadow-lg shadow-violet-900/20">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </button>
        </form>
    </section>

    @* --- DYNAMIC SEARCH HEADER --- *@
    @if (!string.IsNullOrEmpty(Context.Request.Query["searchTerm"]) ||
        (Context.Request.Query["genre"] != "All" && !string.IsNullOrEmpty(Context.Request.Query["genre"])))
    {
        <div class="mb-10 animate-in fade-in slide-in-from-left-5 duration-500">
            <div class="flex items-center gap-4 mb-2">
                @* Violet Accent Bar *@
                <div class="w-1.5 h-8 bg-violet-600 rounded-full shadow-[0_0_15px_rgba(109,40,217,0.5)]"></div>

                <h2 class="text-1.5xl font-black tracking-tight text-white uppercase">
                    @if (!string.IsNullOrEmpty(Context.Request.Query["searchTerm"]))
                    {
                        <span>Results for <span class="text-violet-500 italic">"@Context.Request.Query["searchTerm"]"</span></span>
                    }
                    else
                    {
                        <span>Browsing <span class="text-violet-500 italic">@Context.Request.Query["genre"]</span></span>
                    }
                </h2>
            </div>

            @* Results Count Indicator *@
            <p class="text-zinc-500 text-[10px] font-black uppercase tracking-[0.2em] ml-6">
                @Model.Count() Archives Digitized
            </p>
        </div>
    }

    <section class="flex flex-wrap items-center justify-center gap-4 mb-12">
        <div class="glass p-1.5 rounded-xl flex gap-1">
            <a href="@Url.Action("Index", new { category = "All" })"
               class="px-6 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest @(Context.Request.Query["category"] == "All" || string.IsNullOrEmpty(Context.Request.Query["category"]) ? "bg-violet-600 text-white" : "text-zinc-400 hover:bg-zinc-800 hover:text-white")">
                All
            </a>
            <a href="@Url.Action("Index", new { category = "Movie" })"
               class="px-6 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest @(Context.Request.Query["category"] == "Movie" ? "bg-violet-600 text-white" : "text-zinc-400 hover:bg-zinc-800 hover:text-white")">
                Movie
            </a>
            <a href="@Url.Action("Index", new { category = "Series" })"
               class="px-6 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest @(Context.Request.Query["category"] == "Series" ? "bg-violet-600 text-white" : "text-zinc-400 hover:bg-zinc-800 hover:text-white")">
                Series
            </a>
        </div>

        <div class="relative">
            <button onclick="toggleFilters(event)"
                    class="glass p-1 rounded-xl px-6 py-2 text-[10px] font-black uppercase tracking-widest flex items-center gap-2 text-white hover:bg-violet-600 transition-all">
                <span>More Filters</span>
                <svg id="filterChevron" class="w-3.5 h-3.5 transition-transform duration-300 text-violet-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M19 9l-7 7-7-7"></path>
                </svg>
            </button>

            <div id="filterDropdown" class="hidden absolute top-full left-0 mt-3 w-52 bg-zinc-900/90 backdrop-blur-xl rounded-2xl p-2 z-[60] shadow-2xl border border-white/20">
            <div class="p-2 space-y-1">

                    <a href="@Url.Action("Index", new { sortBy = "year_newest", category = Context.Request.Query["category"] })"
                       class="flex justify-between items-center px-4 py-3 rounded-xl text-[10px] font-black text-white hover:bg-violet-600 transition-all uppercase tracking-widest group">
                        Year (Newest)
                        <span class="opacity-0 group-hover:opacity-100 transition-opacity">🔼</span>
                    </a>

                    <a href="@Url.Action("Index", new { sortBy = "year_oldest", category = Context.Request.Query["category"] })"
                       class="flex justify-between items-center px-4 py-3 rounded-xl text-[10px] font-black text-white hover:bg-violet-600 transition-all uppercase tracking-widest group">
                        Year (Oldest)
                        <span class="opacity-0 group-hover:opacity-100 transition-opacity">🔽</span>
                    </a>

                    <div class="h-px bg-white/10 my-2"></div>

                    <a href="@Url.Action("Index", new { sortBy = "rating", category = Context.Request.Query["category"] })"
                       class="flex justify-between items-center px-4 py-3 rounded-xl text-[10px] font-black text-white hover:bg-violet-600 transition-all uppercase tracking-widest group">
                        Top Rated
                        <span class="opacity-0 group-hover:opacity-100 transition-opacity">★</span>
                    </a>

                    <a href="@Url.Action("Index", new { sortBy = "alphabetical", category = Context.Request.Query["category"] })"
                       class="flex justify-between items-center px-4 py-3 rounded-xl text-[10px] font-black text-white hover:bg-violet-600 transition-all uppercase tracking-widest group">
                        A-Z Order
                        <span class="opacity-0 group-hover:opacity-100 transition-opacity">A</span>
                    </a>

                    <div class="h-px bg-white/10 my-2"></div>

                    <a href="@Url.Action("Index")"
                       class="block px-4 py-3 rounded-xl text-[10px] font-black text-red-400 hover:bg-red-500/10 transition-colors uppercase tracking-widest text-center">
                        Reset All Filters
                    </a>
                </div>
            </div>
        </div>
    </section>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10">
        @foreach (var item in Model)
        {
            <div class="group relative cursor-pointer">
                <div class="aspect-[2/3] rounded-3xl overflow-hidden glass border-zinc-800/50 relative mb-4 shadow-2xl">
                    <img src="@(item.ImagePath ?? "/placeholder.jpg")" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" />

                    <div class="absolute top-4 left-4 flex items-center gap-1.5 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-full border border-white/10">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24" stroke="#fbbf24">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
                        </svg>
                        <span class="text-xs font-black text-yellow-400 tracking-tighter">
                            @item.Rating.ToString("F1", System.Globalization.CultureInfo.InvariantCulture)
                        </span>
                    </div>

                    <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-4">
                        <button onclick="openEditModal('@item.Id', '@item.Title', '@item.Director', '@item.Genre', '@item.Category', '@item.ReleaseYear', '@item.Rating')" class="w-12 h-12 rounded-full bg-violet-600 flex items-center justify-center hover:bg-violet-500 shadow-lg transition-all">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" /><path d="m15 5 4 4" /></svg>
                        </button>
                        <form asp-action="Delete" asp-route-id="@item.Id" method="post">
                            @* delete button *@
                            <button type="button" onclick="openDeleteModal('@item.Id', '@item.Title')" class="w-12 h-12 rounded-full bg-red-600/80 flex items-center justify-center hover:bg-red-500 transition-all">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /></svg>
                            </button>
                        </form>
                    </div>
                </div>
                <h3 class="text-lg font-black text-white group-hover:text-violet-400 transition-colors line-clamp-1 mb-1">@item.Title</h3>
                <div class="flex items-center gap-2">
                    <span class="text-[10px] font-black text-violet-500 uppercase tracking-widest px-2 py-0.5 bg-violet-500/10 rounded">@item.Category</span>
                    <span class="text-[10px] font-bold text-zinc-500 uppercase tracking-widest">@item.Genre • @item.ReleaseYear</span>
                </div>
            </div>
        }
    </div>
</div>

@* --- MODAL: CREATE ENTRY --- *@
<dialog id="createModal" class="bg-zinc-900 border border-zinc-800 rounded-3xl p-0 text-white w-full max-w-lg shadow-2xl overflow-hidden">
    <div class="p-8 border-b border-zinc-800 flex justify-between items-center">
        <h2 class="text-xl font-black uppercase text-violet-500">New Archive Entry</h2>
        <button onclick="document.getElementById('createModal').close()" class="text-zinc-500 hover:text-white">✕</button>
    </div>
    <form asp-action="Create" method="post" enctype="multipart/form-data" class="p-8 space-y-5">
        @* Category *@
        <div>
            <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Category</label>
            <div class="relative">
                <select name="Category" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold outline-none text-white cursor-pointer appearance-none focus:border-violet-500 transition-all">
                    <option value="Movie" class="bg-zinc-900">Movie</option>
                    <option value="Series" class="bg-zinc-900">Series</option>
                </select>
                <div class="absolute inset-y-0 right-4 flex items-center pointer-events-none text-zinc-500">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 9l-7 7-7-7"></path></svg>
                </div>
            </div>
        </div>

        @* Title *@
        <div>
            <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Title</label>
            <input name="Title" placeholder="e.g. Interstellar" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3.5 px-5 font-bold focus:border-violet-500 outline-none transition-all" required />
        </div>

        <div class="grid grid-cols-2 gap-4">
            @* Director *@
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Director/Creator</label>
                <input name="Director" placeholder="Name" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold focus:border-violet-500 outline-none transition-all" required />
            </div>
            @* Genre *@
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Genre</label>
                <div class="relative">
                    <select name="Genre" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold outline-none text-white cursor-pointer appearance-none focus:border-violet-500 transition-all">
                        @if (ViewBag.Genres != null)
                        {
                            foreach (var genre in ViewBag.Genres)
                            {
                                <option value="@genre" class="bg-zinc-900">@genre</option>
                            }
                        }
                    </select>
                    <div class="absolute inset-y-0 right-4 flex items-center pointer-events-none text-zinc-500">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Release Year</label>
                <input name="ReleaseYear" placeholder="e.g. 2026" type="number" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold focus:border-violet-500 outline-none transition-all" />
            </div>
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Rating (1-5)</label>
                <input name="Rating" placeholder="1-5" type="number" step="0.1" min="1.0" max="5.0" value="5.0" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold focus:border-violet-500 outline-none transition-all" />
            </div>
        </div>

        @* Image Input *@
        <div>
            <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Cover Image (JPG, PNG)</label>
            <input type="file" name="imageFile" accept=".jpg, .jpeg, .png" class="w-full text-[10px] text-zinc-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-zinc-800 file:text-zinc-300 file:font-bold file:uppercase cursor-pointer transition-all" />
        </div>

        <div class="flex gap-4 pt-4">
            <button type="button" onclick="document.getElementById('createModal').close()" class="flex-1 bg-zinc-800 py-4 rounded-xl font-black text-[10px] uppercase">Cancel</button>
            <button type="submit" class="flex-[2] btn-violet py-4 rounded-xl font-black text-[10px] uppercase">Confirm</button>
        </div>
    </form>
</dialog>

@* --- MODAL: EDIT ENTRY --- *@
<dialog id="editModal" class="bg-zinc-900 border border-zinc-800 rounded-3xl p-0 text-white w-full max-w-lg shadow-2xl overflow-hidden">
    <div class="p-8 border-b border-zinc-800 flex justify-between items-center">
        <h2 id="editModalTitle" class="text-xl font-black uppercase text-violet-400">Update Entry</h2>
        <button onclick="document.getElementById('editModal').close()" class="text-zinc-500 hover:text-white">✕</button>
    </div>
    <form asp-action="Edit" method="post" enctype="multipart/form-data" class="p-8 space-y-5">
        <input type="hidden" name="Id" id="editId" />

        <div>
            <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Category</label>
            <div class="relative">
                <select name="Category" id="editCategory" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold outline-none text-white cursor-pointer appearance-none focus:border-violet-500 transition-all">
                    <option value="Movie" class="bg-zinc-900">Movie</option>
                    <option value="Series" class="bg-zinc-900">Series</option>
                </select>
                <div class="absolute inset-y-0 right-4 flex items-center pointer-events-none text-zinc-500">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 9l-7 7-7-7"></path></svg>
                </div>
            </div>
        </div>

        <div>
            <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Title</label>
            <input name="Title" id="editTitle" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3.5 px-5 font-bold focus:border-violet-500 outline-none" required />
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Director/Creator</label>
                <input name="Director" id="editDirector" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold focus:border-violet-500 outline-none" required />
            </div>
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Genre</label>
                <div class="relative">
                    <select name="Genre" id="editGenre" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold outline-none text-white cursor-pointer appearance-none focus:border-violet-500 transition-all">
                        @if (ViewBag.Genres != null)
                        {
                            foreach (var genre in ViewBag.Genres)
                            {
                                <option value="@genre" class="bg-zinc-900">@genre</option>
                            }
                        }
                    </select>
                    <div class="absolute inset-y-0 right-4 flex items-center pointer-events-none text-zinc-500">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Release Year</label>
                <input name="ReleaseYear" id="editYear" type="number" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold focus:border-violet-500 outline-none transition-all" />
            </div>
            <div>
                <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Rating  (1-5)</label>
                <input name="Rating" id="editRating" type="number" step="0.1" min="1.0" max="5.0" class="w-full bg-black/40 border border-zinc-700 rounded-xl py-3 px-5 font-bold focus:border-violet-500 outline-none transition-all" />
            </div>
        </div>

        <div>
            <label class="block text-[10px] font-black uppercase tracking-widest text-zinc-500 mb-2 ml-1">Replace Image (JPG, PNG)</label>
            <input type="file" name="imageFile" accept=".jpg, .jpeg, .png" class="w-full text-[10px] text-zinc-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-zinc-800 file:text-zinc-300 file:font-bold file:uppercase cursor-pointer transition-all" />
        </div>

        <div class="flex gap-4 pt-4">
            <button type="button" onclick="document.getElementById('editModal').close()" class="flex-1 bg-zinc-800 py-4 rounded-xl font-black text-[10px] uppercase">Cancel</button>
            <button type="submit" class="flex-[2] btn-violet py-4 rounded-xl font-black text-[10px] uppercase">Save Changes</button>
        </div>
    </form>
</dialog>

@* --- MODAL: DELETE CONFIRMATION --- *@
<dialog id="deleteModal" class="bg-zinc-900 border border-zinc-800 rounded-3xl p-0 text-white w-full max-w-sm shadow-2xl overflow-hidden">
    <div class="p-8 text-center">
        @* Warning Icon *@
        <div class="w-16 h-16 bg-red-500/10 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /></svg>
        </div>

        <h2 class="text-xl font-black uppercase tracking-tighter mb-2">Remove Entry?</h2>
        <p id="deleteModalMessage" class="text-zinc-400 text-xs font-medium px-4 mb-8 leading-relaxed">
            Are you sure you want to delete this archive? This action cannot be undone.
        </p>

        <form id="deleteForm" asp-action="Delete" method="post">
            <input type="hidden" name="id" id="deleteId" />
            <div class="flex gap-3">
                <button type="button" onclick="document.getElementById('deleteModal').close()" class="flex-1 bg-zinc-800 py-4 rounded-xl font-black text-[10px] uppercase hover:bg-zinc-700 transition-all">Cancel</button>
                <button type="submit" class="flex-1 bg-red-600 py-4 rounded-xl font-black text-[10px] uppercase hover:bg-red-500 transition-all shadow-lg shadow-red-900/20">Remove</button>
            </div>
        </form>
    </div>
</dialog>

<script>
    function openDeleteModal(id, title) {
        document.getElementById('deleteId').value = id;
        document.getElementById('deleteModalMessage').innerText = `Are you sure you want to remove "${title}"? This action cannot be undone.`;
        document.getElementById('deleteModal').showModal();
    }
    function openEditModal(id, title, director, genre, category, year, rating) {
        document.getElementById('editModalTitle').innerText = "Edit " + title;
        document.getElementById('editId').value = id;
        document.getElementById('editTitle').value = title;
        document.getElementById('editDirector').value = director;
        document.getElementById('editGenre').value = genre;
        document.getElementById('editCategory').value = category;
        document.getElementById('editYear').value = year;
        document.getElementById('editRating').value = rating.toString().replace(',', '.');
        document.getElementById('editModal').showModal();
    }

    setTimeout(() => {
        const toasts = document.querySelectorAll('.toast-in');
        toasts.forEach(t => {
            t.style.opacity = '0';
            t.style.transition = 'opacity 0.6s ease-out';
            setTimeout(() => t.remove(), 600);
        });
    }, 4000);

        function toggleFilters(event) {
        event.stopPropagation();
        const dropdown = document.getElementById('filterDropdown');
        const chevron = document.getElementById('filterChevron');

        dropdown.classList.toggle('hidden');
        chevron.classList.toggle('rotate-180');
    }

    window.addEventListener('click', function(e) {
        const dropdown = document.getElementById('filterDropdown');
        const chevron = document.getElementById('filterChevron');

        if (!dropdown.contains(e.target)) {
            dropdown.classList.add('hidden');
            chevron.classList.remove('rotate-180');
        }
    });
</script>